# Windows Server Security Auditing & Threat Detection Framework

## üõ°Ô∏è Project Overview
This repository hosts a custom **Endpoint Security Monitoring Framework** designed for **Windows Server 2022**. The project bridges the gap between system administration and security operations (SecOps) by implementing granular audit policies and automated threat detection tools.

The goal was to move beyond default Windows logging to create a "SIEM-lite" environment capable of detecting **Brute Force attacks**, **Lateral Movement**, and **Unauthorized Process Execution** in real-time.

## üöÄ Key Implementations

### 1. Attack Surface Monitoring (GPO Hardening)
Configured **Advanced Audit Policies** to capture high-fidelity security events while reducing log noise.
* [cite_start]**Logon/Logoff Analysis:** Enabled tracking of both successful (Event ID 4624) and failed (Event ID 4625) logons to identify potential credential stuffing or brute force attempts[cite: 8, 17].
* **Process Tracking:** Enabled **Audit Process Creation (Event ID 4688)** with command-line argument logging. [cite_start]This is critical for forensic analysis to see *what* commands an attacker executed, not just *that* they executed something[cite: 12].
* [cite_start]**Object Access & Privilege Use:** Configured monitoring for sensitive file access and privilege escalation attempts[cite: 1374, 1755].

### 2. Threat Hunting Automation (PowerShell)
Developed custom PowerShell tooling to parse the Windows Security Event Log faster than the native Event Viewer GUI.
* [cite_start]**`login_info.ps1`:** An interactive threat hunting tool that filters thousands of logs to pinpoint login activity for specific users, aiding in account compromise investigations[cite: 16].
* **Technique Used:** Utilized `Get-EventLog` with `Where-Object` filtering to correlate `ReplacementStrings` with user input.

### 3. Real-Time Reporting Dashboard
Designed a web-based reporting mechanism to visualize security alerts for non-technical stakeholders.
* [cite_start]**Architecture:** Deployed a local **IIS Web Server** serving a dynamically updated HTML report generated by PowerShell background jobs[cite: 22, 1438].
* [cite_start]**Port Forwarding:** Implemented `netsh interface portproxy` to securely forward traffic from port 8080 to the internal web service[cite: 22, 4849].

## üìÇ Repository Structure

| File / Folder | Description |
| :--- | :--- |
| `Scripts/login_info.ps1` | **Threat Hunting Tool:** Filters Security Log for successful logons (ID 4624) based on target username input. |
| `Scripts/Report_Generator.ps1` | **Automation Service:** Continuously queries logs and converts them into an HTML dashboard hosted on IIS. |
| `Evidence/` | *[Upload your Screenshots Here]* Proof of concept screenshots showing Event Viewer logs and the IIS dashboard. |

## üõ†Ô∏è Technical Details & Event IDs Monitored

This framework specifically targets the following Windows Security Event IDs:

| Event ID | Description | Security Relevance |
| :--- | :--- | :--- |
| **4624** | An account was successfully logged on | Used to baseline normal user activity and detect anomalous login times. |
| **4625** | An account failed to log on | High volumes indicate Brute Force or Password Spraying attacks. |
| **4688** | A new process has been created | The primary indicator for malware execution or unauthorized tool usage (e.g., `whoami`, `net cat`). |
| **4689** | A process has exited | Used to calculate process duration and detect short-lived malicious scripts. |

## ‚ö†Ô∏è Security Considerations
* **Execution Policy:** In this lab environment, the PowerShell Execution Policy was set to `Unrestricted` for testing purposes. In a production environment, I would enforce **`RemoteSigned`** or **`AllSigned`** to prevent the execution of malicious or unverified scripts.
* **Least Privilege:** The reporting script runs with local administrative privileges to access the Security Log. In a production environment, I would delegate specific permissions to a service account using **JEA (Just Enough Administration)**.

## üìú Disclaimer
This project was created for educational and portfolio purposes. The scripts provided are intended for use in authorized testing environments only.
